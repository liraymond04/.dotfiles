xrdb -merge ~/.Xresources

# IBus
export GTK_IM_MODULE=fcitx5
export QT_IM_MODULE=fcitx5
export GLFW_IM_MODULE=ibus
# export XDG_RUNTIME_DIR=/run/user/"$UID"
# export DBUS_SESSION_BUS_ADDRESS=unix:path="$XDG_RUNTIME_DIR"/bus
# export XMODIFIERS=@im=ibus

if [ "$XDG_CURRENT_DESKTOP" = "i3" ]; then
  export GDK_SCALE=1
  export GDK_DPI_SCALE=1
  export QT_ENABLE_HIGHDPI_SCALING=1
fi

# QT
export QT_QPA_PLATFORMTHEME=qt5ct
export QT_AUTO_SCREEN_SCALE_FACTOR=0
# export QT_SCREEN_SCALE_FACTORS=2
export QT_SCALE_FACTOR=1
export KITTY_PLATFORM_CONF=default

if [ "$XDG_CURRENT_DESKTOP" = "i3" ]; then
  export QT_QPA_PLATFORMTHEME=kde
  export QT_SCALE_FACTOR=2
  export KITTY_PLATFORM_CONF=i3
fi

# XDG Paths
export XDG_CONFIG_HOME=$HOME/.config
export XDG_CACHE_HOME=$HOME/.cache
export XDG_DATA_HOME=$HOME/.local/share

# CPU cores
export NUMCPUS=`grep -c '^processor' /proc/cpuinfo`

# Autostart
# ibus-daemon -drx

CONFIG_FILE="$HOME/.config/fcitx5/conf/classicui.conf"

# Desired font settings
I3_FONT="Sans Serif 12"
DEFAULT_FONT="Sans Serif 12"

# Check if running under i3
if [ "$XDG_CURRENT_DESKTOP" = "i3" ]; then
  # Set font for i3
  sed -i "s/^Font=.*/Font=\"$I3_FONT\"/" "$CONFIG_FILE"
else
  # Set default font for other environments
  sed -i "s/^Font=.*/Font=\"$DEFAULT_FONT\"/" "$CONFIG_FILE"
fi
